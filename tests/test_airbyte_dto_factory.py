import pytest
from tests.test_fixtures import *


def test_source_dto__to_payload(dummy_source_dto):
    """
    Test SourceDto.to_payload
    Verifies the data is not mutated by to_payload
    """
    payload = dummy_source_dto.to_payload()
    assert payload['sourceDefinitionId'] == 'ef69ef6e-aa7f-4af1-a01d-ef775033524e'
    assert payload['sourceId'] == '7d95ec85-47c6-42d4-a7a2-8e5c22c810d2'
    assert payload['workspaceId'] == 'f3b9e848-790c-4cdd-a475-5c6bb156dc10'
    assert payload['connectionConfiguration'] == {'access_token': '**********'}
    assert payload['name'] == 'apache/superset'
    assert payload['sourceName'] == 'GitHub'


def test_destination_dto__to_payload(dummy_destination_dto):
    """
    Test DestinationDto.to_payload
    Verifies the data is not mutated by to_payload
    """
    payload = dummy_destination_dto.to_payload()
    assert payload['destinationDefinitionId'] == '25c5221d-dce2-4163-ade9-739ef790f503'
    assert payload['destinationId'] == 'a41cb2f8-fcce-4c91-adfe-37c4586609f5'
    assert payload['workspaceId'] == 'f3b9e848-790c-4cdd-a475-5c6bb156dc10'
    assert payload['connectionConfiguration']['database'] == 'postgres'
    assert payload['connectionConfiguration']['host'] == 'hostname.com'
    assert payload['connectionConfiguration']['schema'] == 'demo'
    assert payload['connectionConfiguration']['username'] == 'devrel_master'
    assert payload['name'] == 'devrel-rds'
    assert payload['destinationName'] == 'Postgres'


def test_connection_dto__to_payload(dummy_connection_dto):
    """
    Test ConnectionDto.to_payload
    Verifies the data is not mutated by to_payload
    """
    payload = dummy_connection_dto.to_payload()
    assert payload['connectionId'] == '10290824-9305-47cc-8966-6dd032abd3c0'
    assert payload['sourceId'] == '7d95ec85-47c6-42d4-a7a2-8e5c22c810d2'
    assert payload['destinationId'] == 'a41cb2f8-fcce-4c91-adfe-37c4586609f5'
    assert payload['name'] == 'default'
    assert payload['prefix'] == 'github_superset_'
    assert payload['schedule'] == {'units': 24, 'timeUnit': 'hours'}
    assert payload['status'] == 'active'
    assert payload['syncCatalog'] == {'streams': [{'stream': {'name': 'assignees', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'repository': {'type': ['string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'assignees', 'selected': True}}, {'stream': {'name': 'branches', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'name': {'type': ['null', 'string']}, 'commit': {'type': ['null', 'object'], 'properties': {'sha': {'type': ['null', 'string']}, 'url': {'type': ['null', 'string']}}}, 'protected': {'type': ['null', 'boolean']}, 'protection': {'type': ['null', 'object'], 'properties': {'required_status_checks': {'type': ['null', 'object'], 'properties': {'contexts': {'type': ['null', 'array'], 'items': [{'type': ['null', 'string']}, {'type': ['null', 'string']}]}, 'enforcement_level': {'type': ['null', 'string']}}}}}, 'repository': {'type': ['string']}, 'protection_url': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [], 'aliasName': 'branches', 'selected': True}}, {'stream': {'name': 'collaborators', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'repository': {'type': ['string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'permissions': {'type': ['null', 'object'], 'properties': {'pull': {'type': ['null', 'boolean']}, 'push': {'type': ['null', 'boolean']}, 'admin': {'type': ['null', 'boolean']}}}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'collaborators', 'selected': True}}, {'stream': {'name': 'comments', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'body': {'type': ['null', 'string']}, 'user': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'node_id': {'type': ['null', 'string']}, 'user_id': {'type': ['null', 'integer']}, 'html_url': {'type': ['null', 'string']}, 'issue_url': {'type': ['null', 'string']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'repository': {'type': ['string']}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'author_association': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['updated_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['updated_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'comments', 'selected': True}}, {'stream': {'name': 'commit_comments', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'body': {'type': ['null', 'string']}, 'line': {'type': ['null', 'integer']}, 'path': {'type': ['null', 'string']}, 'user': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'position': {'type': ['null', 'integer']}, 'commit_id': {'type': ['null', 'string']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'repository': {'type': ['string']}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'author_association': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['updated_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['updated_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'commit_comments', 'selected': True}}, {'stream': {'name': 'commits', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'sha': {'type': ['null', 'string']}, 'url': {'type': ['null', 'string']}, 'commit': {'type': ['null', 'object'], 'properties': {'url': {'type': ['null', 'string']}, 'tree': {'type': ['null', 'object'], 'properties': {'sha': {'type': ['null', 'string']}, 'url': {'type': ['null', 'string']}}}, 'author': {'type': ['null', 'object'], 'properties': {'date': {'type': ['null', 'string'], 'format': 'date-time'}, 'name': {'type': ['null', 'string']}, 'email': {'type': ['null', 'string']}}}, 'message': {'type': ['null', 'string']}, 'committer': {'type': ['null', 'object'], 'properties': {'date': {'type': ['null', 'string'], 'format': 'date-time'}, 'name': {'type': ['null', 'string']}, 'email': {'type': ['null', 'string']}}}, 'verification': {'type': ['null', 'object'], 'properties': {'reason': {'type': ['null', 'string']}, 'payload': {'type': ['null', 'string']}, 'verified': {'type': ['null', 'boolean']}, 'signature': {'type': ['null', 'string']}}}, 'comment_count': {'type': ['null', 'integer']}}}, 'node_id': {'type': ['null', 'string']}, 'parents': {'type': ['null', 'array'], 'items': {'type': ['null', 'object'], 'properties': {'sha': {'type': ['null', 'string']}, 'url': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}}}}, 'html_url': {'type': ['null', 'string']}, 'author_id': {'type': ['null', 'integer']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'repository': {'type': ['string']}, 'comments_url': {'type': ['null', 'string']}, 'committer_id': {'type': ['null', 'integer']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['created_at'], 'sourceDefinedPrimaryKey': [['sha']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['created_at'], 'destinationSyncMode': 'append', 'primaryKey': [['sha']], 'aliasName': 'commits', 'selected': True}}, {'stream': {'name': 'events', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'org_id': {'type': ['null', 'integer']}, 'public': {'type': ['null', 'boolean']}, 'payload': {'type': ['null', 'object'], 'properties': {}}, 'repo_id': {'type': ['null', 'integer']}, 'actor_id': {'type': ['null', 'integer']}, 'created_at': {'type': ['null', 'string']}, 'repository': {'type': ['string']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['created_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['created_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'events', 'selected': True}}, {'stream': {'name': 'issue_events', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'event': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'actor_id': {'type': ['null', 'integer']}, 'issue_id': {'type': ['null', 'integer']}, 'commit_id': {'type': ['null', 'string']}, 'commit_url': {'type': ['null', 'string']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'repository': {'type': ['string']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['created_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['created_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'issue_events', 'selected': True}}, {'stream': {'name': 'issue_labels', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'name': {'type': ['null', 'string']}, 'color': {'type': ['null', 'string']}, 'default': {'type': ['null', 'boolean']}, 'node_id': {'type': ['null', 'string']}, 'repository': {'type': ['string']}, 'description': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'issue_labels', 'selected': True}}, {'stream': {'name': 'issue_milestones', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'state': {'type': ['null', 'string']}, 'title': {'type': ['null', 'string']}, 'due_on': {'type': ['null', 'string'], 'format': 'date-time'}, 'number': {'type': ['null', 'integer']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'closed_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'creator_id': {'type': ['null', 'integer']}, 'labels_url': {'type': ['null', 'string']}, 'repository': {'type': ['string']}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'description': {'type': ['null', 'string']}, 'open_issues': {'type': ['null', 'integer']}, 'closed_issues': {'type': ['null', 'integer']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['updated_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['updated_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'issue_milestones', 'selected': True}}, {'stream': {'name': 'issues', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'body': {'type': ['null', 'string']}, 'user': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'state': {'type': ['null', 'string']}, 'title': {'type': ['null', 'string']}, 'labels': {'type': ['null', 'array'], 'items': {'type': ['null', 'integer']}}, 'locked': {'type': ['null', 'boolean']}, 'number': {'type': ['null', 'integer']}, 'node_id': {'type': ['null', 'string']}, 'user_id': {'type': ['null', 'integer']}, 'comments': {'type': ['null', 'integer']}, 'html_url': {'type': ['null', 'string']}, 'assignees': {'type': ['null', 'array'], 'items': {'type': ['null', 'integer']}}, 'closed_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'events_url': {'type': ['null', 'string']}, 'labels_url': {'type': ['null', 'string']}, 'repository': {'type': ['string']}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'assignee_id': {'type': ['null', 'integer']}, 'comments_url': {'type': ['null', 'string']}, 'milestone_id': {'type': ['null', 'integer']}, 'pull_request': {'type': ['null', 'object'], 'properties': {'url': {'type': ['null', 'string']}, 'diff_url': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'patch_url': {'type': ['null', 'string']}}}, 'repository_url': {'type': ['null', 'string']}, 'active_lock_reason': {'type': ['null', 'string']}, 'author_association': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['updated_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['updated_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'issues', 'selected': True}}, {'stream': {'name': 'organizations', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'blog': {'type': ['null', 'string']}, 'name': {'type': ['null', 'string']}, 'plan': {'type': ['null', 'object'], 'properties': {'name': {'type': ['null', 'string']}, 'seats': {'type': ['null', 'integer']}, 'space': {'type': ['null', 'integer']}, 'filled_seats': {'type': ['null', 'integer']}, 'private_repos': {'type': ['null', 'integer']}}}, 'type': {'type': ['null', 'string']}, 'email': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'company': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'location': {'type': ['null', 'string']}, 'followers': {'type': ['null', 'integer']}, 'following': {'type': ['null', 'integer']}, 'hooks_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'disk_usage': {'type': ['null', 'integer']}, 'events_url': {'type': ['null', 'string']}, 'issues_url': {'type': ['null', 'string']}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'description': {'type': ['null', 'string']}, 'is_verified': {'type': ['null', 'boolean']}, 'members_url': {'type': ['null', 'string']}, 'public_gists': {'type': ['null', 'integer']}, 'public_repos': {'type': ['null', 'integer']}, 'billing_email': {'type': ['null', 'string']}, 'collaborators': {'type': ['null', 'integer']}, 'private_gists': {'type': ['null', 'integer']}, 'twitter_username': {'type': ['null', 'string']}, 'public_members_url': {'type': ['null', 'string']}, 'owned_private_repos': {'type': ['null', 'integer']}, 'total_private_repos': {'type': ['null', 'integer']}, 'has_repository_projects': {'type': ['null', 'boolean']}, 'members_can_create_pages': {'type': ['null', 'boolean']}, 'has_organization_projects': {'type': ['null', 'boolean']}, 'default_repository_permission': {'type': ['null', 'string']}, 'two_factor_requirement_enabled': {'type': ['null', 'boolean']}, 'members_can_create_public_pages': {'type': ['null', 'boolean']}, 'members_can_create_repositories': {'type': ['null', 'boolean']}, 'members_can_create_private_pages': {'type': ['null', 'boolean']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'organizations', 'selected': True}}, {'stream': {'name': 'projects', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'body': {'type': ['null', 'string']}, 'name': {'type': ['null', 'string']}, 'state': {'type': ['null', 'string']}, 'number': {'type': ['null', 'integer']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'owner_url': {'type': ['null', 'string']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'creator_id': {'type': ['null', 'integer']}, 'repository': {'type': ['string']}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'columns_url': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['updated_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['updated_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'projects', 'selected': True}}, {'stream': {'name': 'pull_request_stats', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'merged': {'type': ['null', 'boolean']}, 'number': {'type': ['null', 'integer']}, 'commits': {'type': ['null', 'integer']}, 'node_id': {'type': ['null', 'string']}, 'comments': {'type': ['null', 'integer']}, 'additions': {'type': ['null', 'integer']}, 'deletions': {'type': ['null', 'integer']}, 'mergeable': {'type': ['null', 'boolean']}, 'merged_by': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'rebaseable': {'type': ['null', 'boolean']}, 'repository': {'type': ['string']}, 'changed_files': {'type': ['null', 'integer']}, 'mergeable_state': {'type': ['null', 'string']}, 'review_comments': {'type': ['null', 'integer']}, 'maintainer_can_modify': {'type': ['null', 'boolean']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'pull_request_stats', 'selected': True}}, {'stream': {'name': 'pull_requests', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'base': {'type': ['null', 'object'], 'properties': {'ref': {'type': ['null', 'string']}, 'sha': {'type': ['null', 'string']}, 'label': {'type': ['null', 'string']}, 'repo_id': {'type': ['null', 'integer']}, 'user_id': {'type': ['null', 'integer']}}}, 'body': {'type': ['null', 'string']}, 'head': {'type': ['null', 'object'], 'properties': {'ref': {'type': ['null', 'string']}, 'sha': {'type': ['null', 'string']}, 'label': {'type': ['null', 'string']}, 'repo_id': {'type': ['null', 'integer']}, 'user_id': {'type': ['null', 'integer']}}}, 'user': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'draft': {'type': ['null', 'boolean']}, 'state': {'type': ['null', 'string']}, 'title': {'type': ['null', 'string']}, '_links': {'type': ['null', 'object'], 'properties': {'html': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'self': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'issue': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'commits': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'comments': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'statuses': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'review_comment': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'review_comments': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}}}, 'labels': {'type': ['null', 'array'], 'items': {'type': ['null', 'integer']}}, 'locked': {'type': ['null', 'boolean']}, 'number': {'type': ['null', 'integer']}, 'node_id': {'type': ['null', 'string']}, 'diff_url': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'assignees': {'type': ['null', 'array'], 'items': {'type': ['null', 'integer']}}, 'closed_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'issue_url': {'type': ['null', 'string']}, 'merged_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'patch_url': {'type': ['null', 'string']}, 'auto_merge': {'type': ['null', 'boolean']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'repository': {'type': ['string']}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'assignee_id': {'type': ['null', 'integer']}, 'commits_url': {'type': ['null', 'string']}, 'comments_url': {'type': ['null', 'string']}, 'milestone_id': {'type': ['null', 'integer']}, 'statuses_url': {'type': ['null', 'string']}, 'requested_teams': {'type': ['null', 'array'], 'items': {'type': ['null', 'integer']}}, 'merge_commit_sha': {'type': ['null', 'string']}, 'active_lock_reason': {'type': ['null', 'string']}, 'author_association': {'type': ['null', 'string']}, 'review_comment_url': {'type': ['null', 'string']}, 'requested_reviewers': {'type': ['null', 'array'], 'items': {'type': ['null', 'integer']}}, 'review_comments_url': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['updated_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['updated_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'pull_requests', 'selected': True}}, {'stream': {'name': 'releases', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'body': {'type': ['null', 'string']}, 'name': {'type': ['null', 'string']}, 'draft': {'type': ['null', 'boolean']}, 'assets': {'type': ['null', 'array'], 'items': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'name': {'type': ['null', 'string']}, 'size': {'type': ['null', 'integer']}, 'label': {'type': ['null', 'string']}, 'state': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'uploader_id': {'type': ['null', 'integer']}, 'content_type': {'type': ['null', 'string']}, 'download_count': {'type': ['null', 'integer']}, 'browser_download_url': {'type': ['null', 'string']}}}}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'tag_name': {'type': ['null', 'string']}, 'author_id': {'type': ['null', 'integer']}, 'assets_url': {'type': ['null', 'string']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'prerelease': {'type': ['null', 'boolean']}, 'repository': {'type': ['string']}, 'upload_url': {'type': ['null', 'string']}, 'tarball_url': {'type': ['null', 'string']}, 'zipball_url': {'type': ['null', 'string']}, 'published_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'target_commitish': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['created_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['created_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'releases', 'selected': True}}, {'stream': {'name': 'repositories', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'fork': {'type': ['null', 'boolean']}, 'name': {'type': ['null', 'string']}, 'size': {'type': ['null', 'integer']}, 'owner': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'topics': {'type': ['null', 'array'], 'items': {'type': ['null', 'string']}}, 'git_url': {'type': ['null', 'string']}, 'license': {'type': ['null', 'object'], 'properties': {'key': {'type': ['null', 'string']}, 'url': {'type': ['null', 'string']}, 'name': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'spdx_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}}}, 'node_id': {'type': ['null', 'string']}, 'private': {'type': ['null', 'boolean']}, 'ssh_url': {'type': ['null', 'string']}, 'svn_url': {'type': ['null', 'string']}, 'archived': {'type': ['null', 'boolean']}, 'disabled': {'type': ['null', 'boolean']}, 'has_wiki': {'type': ['null', 'boolean']}, 'homepage': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'keys_url': {'type': ['null', 'string']}, 'language': {'type': ['null', 'string']}, 'tags_url': {'type': ['null', 'string']}, 'blobs_url': {'type': ['null', 'string']}, 'clone_url': {'type': ['null', 'string']}, 'forks_url': {'type': ['null', 'string']}, 'full_name': {'type': ['null', 'string']}, 'has_pages': {'type': ['null', 'boolean']}, 'hooks_url': {'type': ['null', 'string']}, 'pulls_url': {'type': ['null', 'string']}, 'pushed_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'teams_url': {'type': ['null', 'string']}, 'trees_url': {'type': ['null', 'string']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'events_url': {'type': ['null', 'string']}, 'has_issues': {'type': ['null', 'boolean']}, 'issues_url': {'type': ['null', 'string']}, 'labels_url': {'type': ['null', 'string']}, 'merges_url': {'type': ['null', 'string']}, 'mirror_url': {'type': ['null', 'string']}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'visibility': {'type': ['null', 'string']}, 'archive_url': {'type': ['null', 'string']}, 'commits_url': {'type': ['null', 'string']}, 'compare_url': {'type': ['null', 'string']}, 'description': {'type': ['null', 'string']}, 'forks_count': {'type': ['null', 'integer']}, 'is_template': {'type': ['null', 'boolean']}, 'permissions': {'type': ['null', 'object'], 'properties': {'pull': {'type': ['null', 'boolean']}, 'push': {'type': ['null', 'boolean']}, 'admin': {'type': ['null', 'boolean']}}}, 'branches_url': {'type': ['null', 'string']}, 'comments_url': {'type': ['null', 'string']}, 'contents_url': {'type': ['null', 'string']}, 'git_refs_url': {'type': ['null', 'string']}, 'git_tags_url': {'type': ['null', 'string']}, 'has_projects': {'type': ['null', 'boolean']}, 'releases_url': {'type': ['null', 'string']}, 'statuses_url': {'type': ['null', 'string']}, 'assignees_url': {'type': ['null', 'string']}, 'downloads_url': {'type': ['null', 'string']}, 'has_downloads': {'type': ['null', 'boolean']}, 'languages_url': {'type': ['null', 'string']}, 'default_branch': {'type': ['null', 'string']}, 'milestones_url': {'type': ['null', 'string']}, 'stargazers_url': {'type': ['null', 'string']}, 'watchers_count': {'type': ['null', 'integer']}, 'deployments_url': {'type': ['null', 'string']}, 'git_commits_url': {'type': ['null', 'string']}, 'subscribers_url': {'type': ['null', 'string']}, 'contributors_url': {'type': ['null', 'string']}, 'issue_events_url': {'type': ['null', 'string']}, 'stargazers_count': {'type': ['null', 'integer']}, 'subscription_url': {'type': ['null', 'string']}, 'collaborators_url': {'type': ['null', 'string']}, 'issue_comment_url': {'type': ['null', 'string']}, 'notifications_url': {'type': ['null', 'string']}, 'open_issues_count': {'type': ['null', 'integer']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'repositories', 'selected': True}}, {'stream': {'name': 'review_comments', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'body': {'type': ['null', 'string']}, 'line': {'type': ['null', 'integer']}, 'path': {'type': ['null', 'string']}, 'side': {'type': ['null', 'string']}, 'user': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, '_links': {'type': ['null', 'object'], 'properties': {'html': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'self': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'pull_request': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}}}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'position': {'type': ['null', 'integer']}, 'commit_id': {'type': ['null', 'string']}, 'diff_hunk': {'type': ['null', 'string']}, 'created_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'repository': {'type': ['string']}, 'start_line': {'type': ['null', 'integer']}, 'start_side': {'type': ['null', 'string']}, 'updated_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'original_line': {'type': ['null', 'integer']}, 'in_reply_to_id': {'type': ['null', 'integer']}, 'pull_request_url': {'type': ['null', 'string']}, 'original_position': {'type': ['null', 'integer']}, 'author_association': {'type': ['null', 'string']}, 'original_commit_id': {'type': ['null', 'string']}, 'original_start_line': {'type': ['null', 'integer']}, 'pull_request_review_id': {'type': ['null', 'integer']}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['updated_at'], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['updated_at'], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'review_comments', 'selected': True}}, {'stream': {'name': 'reviews', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'body': {'type': ['null', 'string']}, 'user': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'state': {'type': ['null', 'string']}, '_links': {'type': ['null', 'object'], 'properties': {'html': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}, 'pull_request': {'type': ['null', 'object'], 'properties': {'href': {'type': ['null', 'string']}}}}}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'commit_id': {'type': ['null', 'string']}, 'repository': {'type': ['string']}, 'submitted_at': {'type': ['null', 'string'], 'format': 'date-time'}, 'pull_request_url': {'type': ['null', 'string']}, 'author_association': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'reviews', 'selected': True}}, {'stream': {'name': 'stargazers', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'user': {'type': ['null', 'object'], 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'user_id': {'type': ['null', 'integer']}, 'repository': {'type': ['string']}, 'starred_at': {'type': ['null', 'string'], 'format': 'date-time'}}}, 'supportedSyncModes': ['full_refresh', 'incremental'], 'sourceDefinedCursor': True, 'defaultCursorField': ['starred_at'], 'sourceDefinedPrimaryKey': [['user_id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': ['starred_at'], 'destinationSyncMode': 'append', 'primaryKey': [['user_id']], 'aliasName': 'stargazers', 'selected': True}}, {'stream': {'name': 'tags', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'name': {'type': ['null', 'string']}, 'commit': {'type': ['null', 'object'], 'properties': {'sha': {'type': ['null', 'string']}, 'url': {'type': ['null', 'string']}}}, 'node_id': {'type': ['null', 'string']}, 'repository': {'type': ['string']}, 'tarball_url': {'type': ['null', 'string']}, 'zipball_url': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [], 'aliasName': 'tags', 'selected': True}}, {'stream': {'name': 'teams', 'jsonSchema': {'type': 'object', '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'name': {'type': ['null', 'string']}, 'slug': {'type': ['null', 'string']}, 'parent': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'privacy': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'permission': {'type': ['null', 'string']}, 'repository': {'type': ['null', 'string']}, 'description': {'type': ['null', 'string']}, 'members_url': {'type': ['null', 'string']}, 'organization': {'type': ['null', 'string']}, 'repositories_url': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'teams', 'selected': True}}, {'stream': {'name': 'users', 'jsonSchema': {'type': ['null', 'object'], '$schema': 'http://json-schema.org/draft-07/schema#', 'properties': {'id': {'type': ['null', 'integer']}, 'url': {'type': ['null', 'string']}, 'type': {'type': ['null', 'string']}, 'login': {'type': ['null', 'string']}, 'node_id': {'type': ['null', 'string']}, 'html_url': {'type': ['null', 'string']}, 'gists_url': {'type': ['null', 'string']}, 'repos_url': {'type': ['null', 'string']}, 'avatar_url': {'type': ['null', 'string']}, 'events_url': {'type': ['null', 'string']}, 'site_admin': {'type': ['null', 'boolean']}, 'gravatar_id': {'type': ['null', 'string']}, 'starred_url': {'type': ['null', 'string']}, 'organization': {'type': ['null', 'string']}, 'followers_url': {'type': ['null', 'string']}, 'following_url': {'type': ['null', 'string']}, 'organizations_url': {'type': ['null', 'string']}, 'subscriptions_url': {'type': ['null', 'string']}, 'received_events_url': {'type': ['null', 'string']}}}, 'supportedSyncModes': ['full_refresh'], 'sourceDefinedCursor': None, 'defaultCursorField': [], 'sourceDefinedPrimaryKey': [['id']], 'namespace': None}, 'config': {'syncMode': 'full_refresh', 'cursorField': [], 'destinationSyncMode': 'append', 'primaryKey': [['id']], 'aliasName': 'users', 'selected': True}}]}


def test_dto_factory__build_source_dto(dummy_airbyte_dto_factory, dummy_source_dict, dummy_source_dto):
    """
    Test AirbyteDtoFactory.build_source_dto
    """
    t = dummy_airbyte_dto_factory.build_source_dto(dummy_source_dict)
    assert t.source_definition_id == dummy_source_dto.source_definition_id
    assert t.source_id == dummy_source_dto.source_id
    assert t.workspace_id == dummy_source_dto.workspace_id
    assert t.connection_configuration == dummy_source_dto.connection_configuration
    assert t.source_name == dummy_source_dto.source_name
    assert t.name == dummy_source_dto.name
    assert t.tags == dummy_source_dto.tags


def test_dto_factory__build_destination_dto(dummy_airbyte_dto_factory, dummy_destination_dict, dummy_destination_dto):
    """
    Test AirbyteDtoFactory.build_destination_dto
    """
    t = dummy_airbyte_dto_factory.build_destination_dto(dummy_destination_dict)
    assert t.destination_definition_id == dummy_destination_dto.destination_definition_id
    assert t.destination_id == dummy_destination_dto.destination_id
    assert t.workspace_id == dummy_destination_dto.workspace_id
    assert t.connection_configuration == dummy_destination_dto.connection_configuration
    assert t.destination_name == dummy_destination_dto.destination_name
    assert t.name == dummy_destination_dto.name
    assert t.tags == dummy_destination_dto.tags


def test_dto_factory__build_connection_dto(dummy_airbyte_dto_factory, dummy_existing_connection_dict,
                                           dummy_connection_dto):
    """
    Test AirbyteDtoFactory.build_connection_dto
    Ensures that the ConnectionDto being built by the AirbyteDtoFactory is faithful to the input dict
    """
    t = dummy_airbyte_dto_factory.build_connection_dto(dummy_existing_connection_dict)
    assert t.connection_id == dummy_connection_dto.connection_id
    assert t.source_id == dummy_connection_dto.source_id
    assert t.destination_id == dummy_connection_dto.destination_id
    assert t.name == dummy_connection_dto.name
    assert t.prefix == dummy_connection_dto.prefix
    assert t.schedule == dummy_connection_dto.schedule
    assert t.status == dummy_connection_dto.status
    assert t.sync_catalog == dummy_connection_dto.sync_catalog


def test_dto_factory__populate_secrets(dummy_airbyte_dto_factory, dummy_secrets_dict, dummy_source_dto,
                                       dummy_destination_dto):
    """
    Test AirbyteDtoFactory.populate_secrets
    Verifies placeholder secrets in the DTOs are being correctly overridden
    """
    new_dtos = {'sources': [dummy_source_dto], 'destinations': [dummy_destination_dto]}
    dummy_airbyte_dto_factory.populate_secrets(dummy_secrets_dict, new_dtos)
    assert new_dtos['sources'][0].connection_configuration['access_token'] == 'ghp_SECRET_TOKEN'
    assert new_dtos['destinations'][0].connection_configuration['password'] == 'SECRET_POSTGRES_PASSWORD'